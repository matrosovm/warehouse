# warehouse

Сервис для взаимодействия между складами (название, доступность) и товарами (название, размер, уникальный код, количество). 
Товар может быть распределен по разным складам.

Запуск контейнера PostgreSQL: ```make pgdocker-run```

Взаимодействие с миграциями: ```make db-*```

Запуск сервиса: ```make run```

Сервис предоставляет следующее API:
* [резервирование товара](#резервирование)
* [освобождение резерва товара](#освобождение-резерва)
* [получение количества оставшихся товаров на складе](#количество-оставшихся-товаров)

## Резервирование
На вход подается id склада и мапа из уникальных кодов товара и их количества. Переданные товары в случае их наличия на складе резервируются. Возвращается мапа из кодов товара и статусов, отображающих удачно ли прошел резерв. 

Пример запроса:
```
{
    "jsonrpc": "2.0",
    "method": "Service.Reservation",
    "params": [{
    	"warehouse_id": 1,
    	"products": {
    		"1": 1,
    		"2": 1
 		}
 	}],
 	"id": 1
 }
```
Возможный ответ:
```
{
    "id":1,
    "result": {
        "status": {
            "1": false,
            "2": true
        }
    },
    "error":null
}
```

## Освобождение резерва
На вход подается id склада и мапа из уникальных кодов товара и их количества. Возвращается мапа из кодов товара и статусов, отображающих удачно ли прошело освобождение. 

Пример запроса:
```
{
	"jsonrpc": "2.0",
	"method": "Service.ReleaseOfReserved",
	"params": [{
		"warehouse_id": 3,
		"products": {
            "1": 2,
			"3": 1
		}
	}],
	"id": 1
}
```
Возможный ответ:
```
{
    "id":1,
    "result": {
        "status": {
            "1": false,
            "3": true
        }
    },
    "error": null
}
```

## Количество оставшихся товаров
На вход подается id склада, возвращается мапа состоящая из кодов товаров и их количества.

Пример запроса:
```
{
	"jsonrpc": "2.0",
	"method": "Service.RemainingProducts",
	"params": [{
		"warehouse_id": 3
	}],
	"id": 1
}
```
Возможный ответ:
```
{
    "id": 1,
    "result": {
        "products": {
            "3": 10,
            "1": 5,
            "2": 1
        }
    },
    "error": null
}
```